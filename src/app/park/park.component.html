<div fxFlex fxLayout="column" fxLayoutAlign="center center">

  <mat-vertical-stepper #stepper>

    <mat-step [stepControl]="stateFormGroup" state="state">
      <form [formGroup]="stateFormGroup">
        <ng-template matStepLabel>Park by state</ng-template>

        <div>

          <!-- <mat-select placeholder="State" [(ngModel)]="selectedState" name="state"> -->
          <mat-select placeholder="State" formControlName="stateCtrl" name="state">
            <mat-option>None</mat-option>
            <!-- <mat-option [value]="stateFormGroup">Oregon</mat-option> -->
            <!-- <mat-option *ngFor="let state of states" [value]="state">{{ state.name }}</mat-option> -->
            <mat-optgroup *ngFor="let group of stateGroups" [label]="group.name">
              <mat-option *ngFor="let state of group.state" [value]="state">{{ state.name }}</mat-option>
            </mat-optgroup>
          </mat-select>

        </div>

        <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;">
          <button mat-raised-button matStepperNext color="primary">Next</button>
        </div>

      </form>

    </mat-step>

    <mat-step [stepControl]="designationFormGroup" state="designation">
      <form [formGroup]="designationFormGroup">
        <ng-template matStepLabel>Park by designation</ng-template>

        <div fxLayoutGap="20px" fxLayout="column">

          <mat-checkbox formControlName="nationalParkCtrl">
            National Park
          </mat-checkbox>

          <mat-checkbox formControlName="nationalMonumentCtrl">
            National Monument
          </mat-checkbox>

          <mat-checkbox formControlName="nationalHistoricSiteCtrl">
            National Historic Site
          </mat-checkbox>

          <mat-checkbox formControlName="heritageAreaCtrl">
            Heritage Area
          </mat-checkbox>
        </div>

        <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;">
          <button mat-raised-button matStepperPrevious color="accent">Back</button>
          <button mat-raised-button matStepperNext color="primary">Next</button>
        </div>

      </form>

    </mat-step>

    <mat-step [stepControl]="generalParkInfoFormGroup" state="generalParkInformation">

      <form [formGroup]="generalParkInfoFormGroup">
        <ng-template matStepLabel>General park information</ng-template>

        <div fxLayoutGap="20px" fxLayout="column">

          <mat-checkbox formControlName="parkInfoCtrl">
            <mat-icon>info</mat-icon>
            Park Information
          </mat-checkbox>

          <mat-checkbox formControlName="parkWeatherCtrl">
            <mat-icon>wb_sunny</mat-icon>
            Weather
          </mat-checkbox>
        </div>

        <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;">
          <button mat-raised-button matStepperPrevious color="accent">Back</button>
          <button mat-raised-button matStepperNext color="primary">Next</button>
        </div>

      </form>
    </mat-step>


    <mat-step state="done">

      <ng-template matStepLabel>Done</ng-template>
      Get results!
      <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;" fxLayout="column">

        <div fxLayout="row" fxLayoutGap="15px">
          <button mat-raised-button matStepperPrevious color="accent">Back</button>
          <button mat-raised-button color="primary" (click)="onSubmitStepper()">Submit</button>
        </div>

        <div>
          <button mat-stroked-button color="warn" (click)="stepper.reset()">Reset</button>
        </div>

      </div>

    </mat-step>

    <ng-template matStepperIcon="state">
      <mat-icon>place</mat-icon>
    </ng-template>

    <ng-template matStepperIcon="designation">
      <mat-icon>category</mat-icon>
    </ng-template>

    <ng-template matStepperIcon="generalParkInformation">
      <mat-icon>info</mat-icon>
    </ng-template>

    <ng-template matStepperIcon="done">
      <mat-icon>done_all</mat-icon>
    </ng-template>

  </mat-vertical-stepper>

  <div *ngIf="!resultsFound && stepperSubmitted">
    <mat-spinner></mat-spinner>
  </div>

  <div *ngIf="resultsFound">

    <!-- <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="15px"> -->
    <div fxLayoutAlign="space-evenly start">
      <div fxLayout="column" fxFlex="90" fxLayoutGap="15px">

        <!-- <div fxFlex="80"> -->

        <div *ngFor="let foundPark of foundParks">

          <mat-card>
            <mat-card-header>
              <mat-card-title>
                {{ foundPark.fullName }}
              </mat-card-title>
              <mat-card-subtitle>
                {{ foundPark.designation }}
              </mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>

              <div>
                <h4>Description:</h4>
                {{ foundPark.description }}
              </div>

              <div *ngFor="let image of foundPark.images">
                <img mat-card-image [src]="image.url">
                <p>{{ image.title }}</p>
              </div>

              <div *ngIf="foundPark.description && generalParkInfoFormGroup.value.parkInfoCtrl">
                <h4>Park information</h4>
                {{ foundPark.description }}
              </div>

              <div *ngIf="foundPark.description && generalParkInfoFormGroup.value.parkWeatherCtrl">
                <h4>Weather summary</h4>
                {{ foundPark.weatherInfo }}
              </div>

            </mat-card-content>

            <mat-card-actions>

              <a href="{{ foundPark.url }}" mat-raised-button color="primary" target="_blank">Website
              </a>

            </mat-card-actions>

          </mat-card>

        </div>
      </div>
    </div>
  </div>
</div>
