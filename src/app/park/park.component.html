<div fxFlex fxLayout="column" fxLayoutAlign="start center" style="padding-top: 15px;">

  <!-- <h5>Select from the options below to find the park for you</h5> -->
  <h5>Search by state and select the information you need to find the park for you</h5>

  <mat-card>

    <mat-toolbar color="primary">
      <mat-toolbar-row fxLayoutAlign="center center">
        <span>Park Fitter</span>
      </mat-toolbar-row>
    </mat-toolbar>

    <mat-vertical-stepper #stepper>

      <mat-step [stepControl]="stateFormGroup" state="state">

        <form [formGroup]="stateFormGroup">
          <ng-template matStepLabel>Park by State</ng-template>
          <div>

            <mat-select placeholder="State" formControlName="stateCtrl" name="state">
              <mat-option>None</mat-option>

              <mat-divider></mat-divider>

              <mat-optgroup *ngFor="let group of stateGroups" [label]="group.name">
                <mat-option *ngFor="let state of group.state" [value]="state">
                  <img class="option-img" [src]="state.flag" height="25">
                  <span>{{ state.name }}</span>
                </mat-option>
              </mat-optgroup>
            </mat-select>
          </div>
          <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;">
            <button mat-raised-button matStepperNext color="primary">Next</button>
          </div>
        </form>

      </mat-step>

      <!-- <mat-step [stepControl]="designationFormGroup" state="designation">
      <form [formGroup]="designationFormGroup">
        <ng-template matStepLabel>Park by designation</ng-template>

        <div fxLayoutGap="20px" fxLayout="column">

          <mat-checkbox formControlName="nationalParkCtrl">
            National Park
          </mat-checkbox>

          <mat-checkbox formControlName="nationalMonumentCtrl">
            National Monument
          </mat-checkbox>

          <mat-checkbox formControlName="nationalHistoricSiteCtrl">
            National Historic Site
          </mat-checkbox>

          <mat-checkbox formControlName="heritageAreaCtrl">
            Heritage Area
          </mat-checkbox>
        </div>

        <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;">
          <button mat-raised-button matStepperPrevious color="accent">Back</button>
          <button mat-raised-button matStepperNext color="primary">Next</button>
        </div>

      </form>
    </mat-step> -->

      <mat-step [stepControl]="generalParkInfoFormGroup" state="generalParkInformation">

        <form [formGroup]="generalParkInfoFormGroup">
          <ng-template matStepLabel>General Park Information</ng-template>

          <div fxLayoutGap="20px" fxLayout="column">

            <mat-checkbox formControlName="parkInfoCtrl">
              <mat-icon>info</mat-icon>
              Park Information
            </mat-checkbox>

            <mat-checkbox formControlName="parkWeatherCtrl">
              <mat-icon>wb_sunny</mat-icon>
              Weather
            </mat-checkbox>

            <mat-checkbox formControlName="parkDirectionsCtrl">
              <mat-icon>directions</mat-icon>
              Directions
            </mat-checkbox>
          </div>

          <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;">
            <button mat-raised-button matStepperPrevious color="accent">Back</button>
            <button mat-raised-button matStepperNext color="primary">Next</button>
          </div>

        </form>
      </mat-step>

      <mat-step [stepControl]="entranceInfoFormGroup" state="entranceInformation">

        <form [formGroup]="entranceInfoFormGroup">
          <ng-template matStepLabel>Entrance Information</ng-template>

          <div fxLayoutGap="20px" fxLayout="column">

            <mat-checkbox formControlName="entranceInfoCtrl">
              <mat-icon>info</mat-icon>
              Entrance Information
            </mat-checkbox>

            <mat-checkbox formControlName="entranceCostCtrl">
              <mat-icon>attach_money</mat-icon>
              Entrance Cost
            </mat-checkbox>

            <mat-checkbox formControlName="entrancePassCtrl">
              <mat-icon>attach_money</mat-icon>
              Entrance Passes
            </mat-checkbox>

          </div>

          <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;">
            <button mat-raised-button matStepperPrevious color="accent">Back</button>
            <button mat-raised-button matStepperNext color="primary">Next</button>
          </div>

        </form>
      </mat-step>

      <mat-step state="done">

        <ng-template matStepLabel>Done</ng-template>
        Get Results!
        <div fxLayoutGap="15px" style="padding: 30px 30px 0px 0px;" fxLayout="column">

          <div fxLayout="row" fxLayoutGap="15px">
            <button mat-raised-button matStepperPrevious color="accent">Back</button>
            <button mat-raised-button color="primary" (click)="onSubmitStepper()">Submit</button>
          </div>

          <div>
            <button mat-stroked-button color="warn" (click)="stepper.reset()">Reset search</button>
          </div>

        </div>

      </mat-step>

      <ng-template matStepperIcon="state">
        <mat-icon>place</mat-icon>
      </ng-template>

      <ng-template matStepperIcon="designation">
        <mat-icon>category</mat-icon>
      </ng-template>

      <ng-template matStepperIcon="generalParkInformation">
        <mat-icon>info</mat-icon>
      </ng-template>

      <ng-template matStepperIcon="entranceInformation">
        <mat-icon svgIcon="boom-gate-up-outline"></mat-icon>
      </ng-template>

      <ng-template matStepperIcon="done">
        <mat-icon>done_all</mat-icon>
      </ng-template>

    </mat-vertical-stepper>

  </mat-card>

  <div *ngIf="!resultsFound && stepperSubmitted">
    <mat-spinner></mat-spinner>
  </div>

  <div *ngIf="resultsFound">

    <!-- <div *ngIf="stateFormGroup.value.stateCtrl != null && stateFormGroup.value.stateCtrl != undefined"> -->
    <div *ngIf="stateFormGroup.value.stateCtrl !== ''">
      <mat-toolbar fxLayoutAlign="center center" fxLayout="row">
        Parks in {{ stateFormGroup.value.stateCtrl.name }}
        <img [src]="stateFormGroup.value.stateCtrl.flag" height="55" style="padding-left: 15px">
      </mat-toolbar>
    </div>

    <div fxLayoutAlign="space-evenly start">
      <div fxLayout="column" fxFlex="90" fxLayoutGap="15px">

        <div *ngFor="let foundPark of foundParks">

          <mat-card>

            <mat-card-header fxLayoutAlign="center center" fxLayout="column">
              <mat-card-title>
                <a href="{{ foundPark.url }}" target="_blank" style="text-decoration: none;">
                  {{ foundPark.fullName }}</a>
              </mat-card-title>
              <mat-card-subtitle>
                {{ foundPark.designation }}
              </mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>

              <div fxLayout="column" fxLayoutAlign="space-around center">

                <div *ngFor="let image of foundPark.images">
                  <img mat-card-image [src]="image.url" style="max-width:350px;">
                  <mat-card-subtitle>{{ image.title }}</mat-card-subtitle>
                  <!-- <mat-card-subtitle>{{ image.caption }}</mat-card-subtitle> -->
                </div>
              </div>

              <!-- <slideshow [imageUrls]="this.foundParkImageArray">
              </slideshow> -->

              <slideshow [imageUrls]="slideshowImageArray" [minHeight]="'300px'">
              </slideshow>

              <h4>Description:</h4>
              {{ foundPark.description }}

              <div *ngIf=" foundPark.description && generalParkInfoFormGroup.value.parkInfoCtrl">
                <h4>Park information</h4>
                <p>{{ foundPark.description }}</p>
              </div>

              <div *ngIf="foundPark.weatherInfo && generalParkInfoFormGroup.value.parkWeatherCtrl">
                <h4>Weather summary</h4>
                {{ foundPark.weatherInfo }}
              </div>

              <div *ngIf="foundPark.directionsInfo && generalParkInfoFormGroup.value.parkDirectionsCtrl;">
                <h4>Directions:</h4>
                {{ foundPark.directionsInfo }}
              </div>

              <!-- <div *ngIf="foundPark.entranceFees[0] && entranceInfoFormGroup.value.entranceCostCtrl">
                <h4>Entrance Fee:</h4>
                {{ foundPark.entranceFees[0].cost }}
              </div>
               -->
              <div
                *ngIf="(foundPark.entranceFees[0] && entranceInfoFormGroup.value.entranceCostCtrl) || (foundPark.entranceFees[0] && entranceInfoFormGroup.value.entranceInforCtrl)">

                <h4>Entrance Fees:</h4>

                <ul *ngFor="let entranceFee of foundPark.entranceFees">
                  <!-- <li>Entrance Fee:</li> -->
                  {{ entranceFee.title }} - {{ entranceFee.description }}
                  ${{ entranceFee.cost }}
                </ul>
              </div>

              <div *ngIf="(foundPark.entrancePasses[0] && entranceInfoFormGroup.value.entrancePassCtrl)">

                <ul *ngFor="let entrancePass of foundPark.entrancePasses">
                  <li>Entrance Pass:</li>
                  {{ entrancePass.cost }}
                </ul>

                <ul *ngFor="let entrancePass of foundPark.entrancePasses">
                  <!-- <li>Entrance Fee:</li> -->
                  {{ entrancePass.title }} - {{ entrancePass.description }}
                </ul>
              </div>

              <!-- <ng-template #directionsNotAvailable>Directions not available</ng-template> -->

            </mat-card-content>

            <mat-card-actions fxLayoutGap="20px" fxLayout="row" fxLayoutAlign="center center">

              <a href="{{ foundPark.url }}" mat-stroked-button color="primary" target="_blank"> {{ foundPark.name }}
                Website
              </a>

              <div *ngIf="foundPark.directionsUrl && generalParkInfoFormGroup.value.parkDirectionsCtrl">
                <a href="{{ foundPark.directionsUrl }}" mat-stroked-button color="primary" target="_blank">Directions
                </a>
              </div>

            </mat-card-actions>

          </mat-card>

        </div>
      </div>
    </div>
  </div>


</div>
